<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cancel Context Collector - Waitlist</title>
  <link rel="stylesheet" href="/waitlist/styles.css" />
</head>
<body>
  <main class="page">
    <section class="hero">
      <div class="card">
        <p class="eyebrow">Cancel Context Collector</p>
        <h1>Stop guessing why customers cancel</h1>
        <p class="sub">
          Capture cancellation reasons with real usage context — not vague survey answers.
        </p>

        <form class="waitlist" method="post" action="#" id="waitlistForm">
          <label>
            <span>Email</span>
            <input type="email" name="email" placeholder="you@company.com" required />
          </label>
          <label>
            <span>Your SaaS URL</span>
            <input type="url" name="saas_url" placeholder="https://yourapp.com" required />
          </label>
          <button type="submit" id="waitlistSubmit">Request early access</button>
          <p class="fine">Early supporter plan: $49 one-time, lifetime discount.</p>
          <div class="success" id="waitlistSuccess" role="status" aria-live="polite">
            Thanks — you're on the waitlist. We'll reach out soon.
          </div>
        </form>
      </div>
    </section>

    <section class="problem">
      <h2>Stripe tells you they cancelled. It doesn’t tell you why.</h2>
      <ul>
        <li>"Too expensive" isn’t actionable</li>
        <li>Surveys give vague answers</li>
        <li>You fix the wrong things</li>
      </ul>
    </section>

    <section class="solution">
      <h2>Cancellation context, delivered instantly</h2>
      <ul>
        <li>One-click cancel survey</li>
        <li>Last page context</li>
        <li>Device and browser data</li>
        <li>Instant founder email</li>
      </ul>
    </section>

    <section class="supporter">
      <div class="card">
        <h2>Early supporter plan</h2>
        <p>Join early and lock in a lifetime discount.</p>
        <p class="price">$49 one-time for early access.</p>
        <p class="muted">We’ll connect the waitlist form to a database later.</p>
      </div>
    </section>
  </main>
  <script>
    (function () {
      const form = document.getElementById("waitlistForm");
      const success = document.getElementById("waitlistSuccess");
      const submit = document.getElementById("waitlistSubmit");
      if (!form || !success || !submit) return;
      form.addEventListener("submit", async function (event) {
        event.preventDefault();
        submit.disabled = true;
        submit.textContent = "Submitting...";

        const payload = {
          email: form.email.value.trim(),
          saas_url: form.saas_url.value.trim()
        };

        try {
          const response = await fetch("/api/waitlist", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
          });

          const data = await response.json().catch(function () {
            return null;
          });

          if (!response.ok) {
            const message = (data && (data.error || data.detail)) || "Submit failed.";
            throw new Error(message);
          }

          success.textContent = "Thanks — you're on the waitlist. We'll reach out soon.";
          success.classList.add("show");
          form.reset();
        } catch (err) {
          success.textContent = err && err.message ? err.message : "Something went wrong. Please try again.";
          success.classList.add("show");
        } finally {
          submit.disabled = false;
          submit.textContent = "Request early access";
        }
      });
    })();
  </script>
</body>
</html>
